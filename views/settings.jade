extends ./layout

block sub_layout

  body.portfolio-bkg

    .toolbar.toolbar-absolute.toolbar-dark:.max-width
      include ./includes/toolbar.jade

    .portfolio-content:.max-width

      p #{errors}

      .small-label OWNERS
        for o in all_owners
          p #{o.name} 
            a: i.fa.fa-edit(data-toggle="modal" data-target="#edit-owner-form" id='edit-'+o.id)
          br

      include ./modals/edit_owner.jade
      include ./modals/add_owner.jade

      a(data-toggle="modal" data-target="#add-owner-form")
        i.fa.fa-plus#add-owner-btn  Add owner

      script.
        // grabs all_owners from routes & puts it into owners var
        var owners = !{JSON.stringify(all_owners)};

        /* iterate through owners' edit btns so that onclick, the form is
         * populated with that owner's info */
        for (var i = 0; i < owners.length; i++) {
          (function(n) {
            var o = owners[i];
            $('#edit-'+o._id).click(function() {

              $('#name').val(o.name);
              $('#email').val(o.email);
              $("input.edit:checkbox").each(function(){
                if (o.companies.indexOf($(this).val()) != -1){
                  $(this).prop('checked', true);
                }
              });
              console.log(o._id);
              $('#id').val(o._id);
            });
          }(i))
        }